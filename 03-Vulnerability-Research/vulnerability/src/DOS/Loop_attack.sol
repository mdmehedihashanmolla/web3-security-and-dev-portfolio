// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

contract VulnerableLoop {
    address[] public users;
    uint256 public totalBalance;

    function addUser(address _user) public payable {
        users.push(_user);
        totalBalance += msg.value;
    }

    function distributeFunds() public {
        for (uint256 i = 0; i < users.length; i++) {
            // Transfer funds to each user
            (bool success, ) = users[i].call{value: totalBalance / users.length}("");
            require(success, "Transfer failed");
        }
    }

    function getUserCount() public view returns (uint256) {
        return users.length;
    }
}